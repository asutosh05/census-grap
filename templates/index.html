<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
     <script src="https://code.jquery.com/jquery-3.1.1.min.js" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" integrity="sha384-awusxf8AUojygHf2+joICySzB780jVvQaVCAt1clU3QsyAitLGul28Qxb2r1e5g+" crossorigin="anonymous">
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
        
       
</head>
<body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="#">Census Data</a>
    </div>
    <!--<ul class="nav navbar-nav">-->
    <!--  <li class="active"><a href="#">Home</a></li>-->
    <!--  <li><a href="#">Page 1</a></li>-->
    <!--  <li><a href="#">Page 2</a></li>-->
    <!--  <li><a href="#">Page 3</a></li>-->
    <!--</ul>-->
  </div>
</nav>

<div class="container" style="margin-top:50px">
  <h3>Chats</h3>
  <div class="row">
    <div class="col-md-6">
     <div id="maleFemaleRation">
         
     </div>  
    </div>
    <div class="col-md-6"> 
            <div id="genderRatio">
         
             </div>
     </div>
  </div>
</div>

<div></div>

<script type="text/javascript">
    $(document).ready(function () {
        getGenderData()
        getRelationshipData()
        });
        function getGenderData() {
            $.ajax({
                url: 'gender',
                dataType: 'json',
                type: 'GET',
                success: function (data) {
                        buildGenderchat(data);
                    
                }
            });
        };
    function buildGenderchat(data) {
            Highcharts.chart('maleFemaleRation', {
                chart: {
                    plotBackgroundColor: null,
                    plotBorderWidth: null,
                    plotShadow: null,
                    type:'pie'
                },
                title: {
                    text:'Pi Chat Male And Female Ratio'
                },
                tooltip: {
                    pointFormat:'{series.name}:<b>{point.percentage:1f}%</b>'
                },
                plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: true,
                            format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                            style: {
                                color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                            }
                        }
                    }
                },
                series:getGenderPercentage(data)
            });
    };
    function getGenderPercentage(data){
          var obj = JSON.parse(data)
          var Male_Count=obj["Male"]
          var Female_count= obj["Female"]
          console.log(Male_Count)
          return [{
                name: 'Counts',
                data: [
                    {
                    name: 'Male',
                    y: Male_Count
                    }, {
                    name: 'Female',
                        y: Female_count,
                        sliced: true,
                    }              
                ]
            }]
        };

         function getRelationshipData() {
            $.ajax({
                url: 'relationship',
                dataType: 'json',
                type: 'GET',
                success: function (data) {                        
                    buildRelationshipChat(data);
                    
                }
            });
        };
       

    function buildRelationshipChat(data) {
            Highcharts.chart('genderRatio', {
                chart: {
                    plotBackgroundColor: null,
                    plotBorderWidth: null,
                    plotShadow: null,
                    type:'pie'
                },
                title: {
                    text:'Pi Chat Relationship'
                },
                tooltip: {
                    pointFormat:'{series.name}:<b>{point.percentage:1f}%</b>'
                },
                plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: true,
                            format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                            style: {
                                color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                            }
                        }
                    }
                },
                series:getRelationshipPercentage(data)
            });
    };
    function getRelationshipPercentage(data){
          var obj = JSON.parse(data)
          return [{
                name: 'Counts',
                data: [
                    {
                    name: "Other-relative",
                    y: obj["Other-relative"]
                    }, {
                    name: 'Unmaried"',
                        y: obj["Unmarried"],
                        sliced: true,
                    } 
                    , {
                    name: 'Husband',
                        y: obj["Husband"],
                        sliced: true,
                    }   , {
                    name: 'Own-child',
                        y: obj["Own-child"],
                        sliced: true,
                    }   , {
                    name: 'Not-in-family',
                        y: obj["Not-in-family"],
                        sliced: true,
                    }   , {
                    name: 'Wife',
                        y: obj["Wife"],
                        sliced: true,
                    }            
                ]
            }]
        };
       
</script>
</body>
</html>